# -*- coding: utf-8 -*-

#BIBLIOTECAS
import clr
import System
clr.AddReference('RevitAPI') 
from Autodesk.Revit.DB import BuiltInCategory, FilteredElementCollector
clr.AddReference('RevitServices')
from RevitServices.Persistence import DocumentManager

doc = DocumentManager.Instance.CurrentDBDocument

#FUNCIONES
def todos_elementos_de_categoria_3(cat):
	"""
	Uso: Obtiene todos las instancias de la categoría especificada dentro del documento. Categoría (IN[0])
	La categoría puede ser seleccionada desde Dynamo, ser una BuiltInCategory o una BuiltInCategory como string.
	"""

	bics = System.Enum.GetValues(BuiltInCategory)
	bicn = map(lambda a: str(a), bics)
	salida = None

	if cat.GetType().ToString() == "System.String":
		for n,c in zip(bicn,bics):
			if cat == n:
				salida = c
	elif cat.GetType().ToString() == "Revit.Elements.Category":
		salida = System.Enum.ToObject(BuiltInCategory, cat.Id)
	elif cat.GetType().ToString() == "Autodesk.Revit.DB.BuiltInCategory":
		salida = cat
	else: 
		pass
	return FilteredElementCollector(doc).OfCategory(salida).WhereElementIsNotElementType().ToElements()


#ENTRADAS
elemento = IN[0] #String(BuiltInCategory), BuiltInCategory o categoría del selector de categorias de Dynamo.
#SALIDA
OUT = todos_elementos_de_categoria_3(elemento)
